<!doctype html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">  
    <title>Генератор заданий</title>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>
    <script type="text/javascript" src="generator2.0.js"></script>
  	<link rel="stylesheet" type="text/css" href='style.css'>
</head>
<body>
	<div class=app>
		<div class=header>
			<input type='number' id='minInput' placeholder='Min'>
			<input type='number' id='maxInput' placeholder='Max'>
			<input type='number' id='fixedInput' placeholder='Fixed'>
			<input type='checkbox' id='shuffleButton' name='Shuffle'>
			<label for="shuffle">Shuffle</label>
			<button id='generate'>Generate</button>
		</div>
		<div class=input>
			<textarea class='textField' id='inputContainer'></textarea>
		</div>
		<div class='preview textField'>
			<div id='previewContainer'></div>
		</div>
		<div class=footer></div>
	</div>
	<div class='print textField' style="display:none" id=printContainer></div>
	<script>
		inputContainer = document.getElementById('inputContainer');
		previewContainer = document.getElementById('previewContainer');
		
		getTask = function() {
			if (inputContainer.value!='') {
				pattern = inputContainer.value.split('\n');
				pattern = generator.generateSeries(pattern);
				pattern = pattern.map(el => '\\('+generator.generate(el)+'\\)');
				return pattern
			}
			else return [];
		}
		
		getPreview = function () {
			previewContainer.innerHTML='';
			task = getTask();
			task.forEach(el => previewContainer.innerHTML+=el+'<br>');
			MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
		}

		printContainer = document.getElementById('printContainer');
		getPrint = function() {
			printContainer.innerHTML='';
			for (k=0;k<30;k++) {
				div=document.createElement('div');
				task = getTask();
				task.forEach(el => div.innerHTML+=el+'<br>');
				printContainer.appendChild(div);
			}
			MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
		}

		inputContainer.oninput = () => getPreview();
		minInput = document.getElementById('minInput');
		minInput.onchange = () => {generator.min = parseInt(minInput.value); getPreview();}
		maxInput = document.getElementById('maxInput');
		maxInput.onchange = () => {generator.max = parseInt(maxInput.value); getPreview();}
		fixedInput = document.getElementById('fixedInput');
		fixedInput.onchange = () => {generator.round = parseInt(fixedInput.value); getPreview();}
		shuffleButton = document.getElementById('shuffleButton');
		shuffleButton.onchange= () => {generator.shuffle=shuffleButton.checked; getPreview();}
		generateButton = document.getElementById('generate');
		generateButton.onclick = () => {
			if ((printContainer.style.display=='none') && (inputContainer.value!='')) {
				getPrint();
				printContainer.style.display='grid';
				generateButton.innerText='Return';
			}
			else {
				printContainer.style.display='none';
				generateButton.innerText='Generate';
			}
		}
	</script>
</body>
</html>